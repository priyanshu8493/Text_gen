<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Text Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center">
    <div class="w-full max-w-xl p-8 bg-gray-800 rounded-xl shadow-lg">
        <h1 class="text-3xl font-bold mb-6 text-center">Text Generator</h1>

        <textarea id="prompt" class="w-full p-3 text-gray-900 rounded" rows="4" placeholder="Enter prompt..."></textarea>

        <button id="generateBtn" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
            Generate
        </button>

        <div id="response" class="mt-6 p-4 bg-gray-700 rounded whitespace-pre-wrap"></div>
    </div>

    <script>
    document.getElementById("generateBtn").addEventListener("click", async () => {
        const prompt = document.getElementById("prompt").value;
        const responseDiv = document.getElementById("response");

        responseDiv.textContent = "⏳ Generating...";

        const res = await fetch("https://server.aimliedc.tech/text-generator/generate_text/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": getCookie("csrftoken")
            },
            body: JSON.stringify({ prompt })
        });
        const text = await res.text();
        responseDiv.textContent = text.trim();

        if (!res.ok) {
            responseDiv.textContent = "❌ Error: " + res.statusText;
            return;
        }

        responseDiv.textContent = "";

        const reader = res.body.getReader();
        const decoder = new TextDecoder("utf-8");

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;
            responseDiv.textContent += decoder.decode(value, { stream: true });
        }
    });

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                cookie = cookie.trim();
                if (cookie.startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.slice(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>


</body>
</html>
